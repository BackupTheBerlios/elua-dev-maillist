<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [eLua-dev] Unexpected behaviour in cpu module
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/elua-dev/2011-December/index.html" >
   <LINK REL="made" HREF="mailto:elua-dev%40lists.berlios.de?Subject=Re%3A%20%5BeLua-dev%5D%20Unexpected%20behaviour%20in%20cpu%20module&In-Reply-To=%3CCAENe87oMeePzKijoVMa%2BOseGL6%2BNgi%2BfCi04qBzcfpGHnTji2w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003080.html">
   <LINK REL="Next"  HREF="003083.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[eLua-dev] Unexpected behaviour in cpu module</H1>
    <B>Brian Thorne</B> 
    <A HREF="mailto:elua-dev%40lists.berlios.de?Subject=Re%3A%20%5BeLua-dev%5D%20Unexpected%20behaviour%20in%20cpu%20module&In-Reply-To=%3CCAENe87oMeePzKijoVMa%2BOseGL6%2BNgi%2BfCi04qBzcfpGHnTji2w%40mail.gmail.com%3E"
       TITLE="[eLua-dev] Unexpected behaviour in cpu module">hardbyte at gmail.com
       </A><BR>
    <I>Wed Dec  7 01:33:21 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003080.html">[eLua-dev] Unexpected behaviour in cpu module
</A></li>
        <LI>Next message: <A HREF="003083.html">[eLua-dev] Unexpected behaviour in cpu module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3082">[ date ]</a>
              <a href="thread.html#3082">[ thread ]</a>
              <a href="subject.html#3082">[ subject ]</a>
              <a href="author.html#3082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the reply Bogdan,

So cpu.w8 works as expected for SRAM addresses but not for peripheral
registers.

Looking at the code in cpu.c the implementation appears to be entirely
platform independent, and reading the memory model documentation for the
LM3S it doesn't specify any behaviour like this. Does it not seem odd that
two different chips would have the same hardware problem?

Cheers,

On 7 December 2011 10:33, Bogdan Marinescu &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/elua-dev">bogdan.marinescu at gmail.com</A>&gt;wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> On Tue, Dec 6, 2011 at 11:21 PM, Brian Thorne &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/elua-dev">hardbyte at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi all,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I came across some strange behaviour when writing to the first 8 bits of
</I>&gt;&gt;<i> a 32 bit register from elua with cpu.w8. The lua code seems to write copies
</I>&gt;&gt;<i> of the 8 bits to all other writeable bits in the targeted 32bit register;
</I>&gt;&gt;<i> if the register has RO bits they are unaffected. I have seen this on two
</I>&gt;&gt;<i> different boards (LM3S and an STM32F1). Is this expected and desired
</I>&gt;&gt;<i> behaviour? If so could we make this clearer in the documentation?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Using cpu.w8 with hardware bitbanding from the micro's datasheet or using
</I>&gt;&gt;<i> cpu.w32 were the two methods I found to successfully write to just the byte
</I>&gt;&gt;<i> referenced.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The code for cpu.w8 looks OK to me. I believe that some CPU registers are
</I>&gt;<i> simply not byte addressable. Try cpu.w8 on a memory location (for example a
</I>&gt;<i> fixed RAM address); if it works as expected, the problem is definitely in
</I>&gt;<i> the hardware.
</I>&gt;<i>
</I>&gt;<i> Best,
</I>&gt;<i> Bogdan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Brian
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/elua-dev/attachments/20111207/08a6b77c/attachment.html">https://lists.berlios.de/pipermail/elua-dev/attachments/20111207/08a6b77c/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003080.html">[eLua-dev] Unexpected behaviour in cpu module
</A></li>
	<LI>Next message: <A HREF="003083.html">[eLua-dev] Unexpected behaviour in cpu module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3082">[ date ]</a>
              <a href="thread.html#3082">[ thread ]</a>
              <a href="subject.html#3082">[ subject ]</a>
              <a href="author.html#3082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/elua-dev">More information about the eLua-dev
mailing list</a><br>
</body></html>
