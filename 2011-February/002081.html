<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [eLua-dev]  AVR32 PX patch (again/still)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/elua-dev/2011-February/index.html" >
   <LINK REL="made" HREF="mailto:elua-dev%40lists.berlios.de?Subject=Re%3A%20%5BeLua-dev%5D%20%20AVR32%20PX%20patch%20%28again/still%29&In-Reply-To=%3CAANLkTink31TOyV7TNYoHBhUC1wJzOCownoRMRmC2Kt4W%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002082.html">
   <LINK REL="Next"  HREF="002083.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[eLua-dev]  AVR32 PX patch (again/still)</H1>
    <B>Bogdan Marinescu</B> 
    <A HREF="mailto:elua-dev%40lists.berlios.de?Subject=Re%3A%20%5BeLua-dev%5D%20%20AVR32%20PX%20patch%20%28again/still%29&In-Reply-To=%3CAANLkTink31TOyV7TNYoHBhUC1wJzOCownoRMRmC2Kt4W%40mail.gmail.com%3E"
       TITLE="[eLua-dev]  AVR32 PX patch (again/still)">bogdan.marinescu at gmail.com
       </A><BR>
    <I>Wed Feb 23 09:06:26 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002082.html">[eLua-dev] External Libraries and Headers for eLua
</A></li>
        <LI>Next message: <A HREF="002083.html">[eLua-dev] AVR32 PX patch (again/still)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2081">[ date ]</a>
              <a href="thread.html#2081">[ thread ]</a>
              <a href="subject.html#2081">[ subject ]</a>
              <a href="author.html#2081">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>...did I mention how much I hate &quot;reply all&quot; ? :)


---------- Forwarded message ----------
From: Bogdan Marinescu &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/elua-dev">bogdan.marinescu at gmail.com</A>&gt;
Date: Wed, Feb 23, 2011 at 10:05 AM
Subject: Re: [eLua-dev] AVR32 PX patch (again/still)
To: Martin Guy &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/elua-dev">martinwguy at gmail.com</A>&gt;


On Wed, Feb 23, 2011 at 1:45 AM, Martin Guy &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/elua-dev">martinwguy at gmail.com</A>&gt; wrote:
&gt;<i> No, I'm using newlib, which is smaller, not simple which is even
</I>&gt;<i> smaller but had that startup time problem
</I>&gt;<i>
</I>&gt;<i> scons board=mizar32 target=lualong allocator=newlib optram=0
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> Programming 123164 bytes in 4 segments.
</I>&gt;<i> &#160; &#160; Verifying flash: ================================================== 100.0%
</I>&gt;<i> Verify failed at address 0x80020000. Expected 00, read e1.
</I>&gt;<i>
</I>&gt;<i> If you're interested in &quot;size&quot; I get:
</I>&gt;<i> &#160;120320 &#160; &#160;1364 &#160; &#160;1480 &#160;123164 &#160; 1e11c elua_lualong_at32uc3a0128.elf
</I>&gt;<i>
</I>&gt;<i> I guess you're not counting the BSS and DATA in the 120KB,
</I>
We've been over this before and I maintain my position: a target
downloader program should NOT write the .bss segment into Flash. It
makes not sense at all to write into Flash something that is ALWAYS 0.
There's a reason why the .bss segment has the type NOLOAD in the elf
section headers and even a basic downloader tool should take this into
account. I do not intend to modify eLua to compensate for faulty 3rd
party tools especially when there are alternatives:

- Linux: use dfu-programmer
- Windows: use FLIP (batchisp)

Both will flash a hex file instead of the elf. The hex image is
correctly generated by the eLua build system (it doesn't contain the
.bss image) so you won't have this problem anymore. Try this if you
have some time:

1. svn update the Lua trunk
2. $ sudo luarocks install lpack
3. $ sudo luarocks install luafilesystem
4. put your board in DFU mode and connect it to the PC
5. $ lua build_elua.lua board=mizar32 target=lualong burn

This sequence build the image and uses dfu-programmer to write it to
target, all with a single command. I'm really curious if that works
for you.

&gt;<i> Well, in the AVR stuff there was the EVK1100 serial port not working
</I>&gt;<i> at all due to being configured in SERMUX mode,
</I>
Hmmmm. I can understand why that would be regarded as an issue by some
and as a feature by others :) The rationale behind this decision
(leaving RFS + sermux enabled for ATEVK1100) was that EVK1100 has
enough resources to accomodate a larger configuration and RFS is a
nice thing to have. That said, I understand the downside, plus I know
that this kind of stuff should really be documented somewhere (most
likely on the wiki).

&gt;<i> the image being &gt;128KB for Mizar32 by default, I forget if there were
</I>&gt;<i> others.
</I>
I think another issue was the HW flow control not working properly on
AVK1100 and possibly other AVR32 targets. I didn't have time to
investigate, sorry.

Best,
Bogdan

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002082.html">[eLua-dev] External Libraries and Headers for eLua
</A></li>
	<LI>Next message: <A HREF="002083.html">[eLua-dev] AVR32 PX patch (again/still)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2081">[ date ]</a>
              <a href="thread.html#2081">[ thread ]</a>
              <a href="subject.html#2081">[ subject ]</a>
              <a href="author.html#2081">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/elua-dev">More information about the eLua-dev
mailing list</a><br>
</body></html>
